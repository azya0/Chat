{"ast":null,"code":"import Cookies from \"js-cookie\";\nimport axios from \"axios\";\nfunction auth_headers() {\n  return Cookies.get('access_token') !== null ? {\n    headers: {\n      Authorization: `${Cookies.get('token_type')} ${Cookies.get('access_token')}`\n    }\n  } : {};\n}\nasync function setCurrentUser(email, password) {\n  async function GetToken(email, password) {\n    const params = new URLSearchParams({\n      'username': email,\n      'password': password\n    });\n    try {\n      let response = await axios.post('http://localhost:443/auth/jwt/login', params);\n      return response.data;\n    } catch (error) {\n      console.log(error);\n    }\n  }\n  try {\n    const data = await GetToken(email, password);\n    for (const [key, value] of Object.entries(data)) {\n      Cookies.set(key, value);\n    }\n    const response = await axios.get('http://localhost:443/users/me', auth_headers());\n    localStorage.setItem('current_user', JSON.stringify(response.data));\n    return 0;\n  } catch (error) {\n    console.log(error);\n  }\n  return -1;\n}\nfunction currentUser() {\n  if (Cookies.get('access_token') == null) {\n    localStorage.setItem('current_user', null);\n    return null;\n  }\n  const data = localStorage.getItem('current_user');\n  if (data !== null) return JSON.parse(data);\n  return null;\n}\nfunction clearCurrentUser() {\n  localStorage.setItem('current_user', null);\n  Cookies.remove('access_token');\n  Cookies.remove('token_type');\n}\nexport { auth_headers, setCurrentUser, currentUser, clearCurrentUser };","map":{"version":3,"names":["Cookies","axios","auth_headers","get","headers","Authorization","setCurrentUser","email","password","GetToken","params","URLSearchParams","response","post","data","error","console","log","key","value","Object","entries","set","localStorage","setItem","JSON","stringify","currentUser","getItem","parse","clearCurrentUser","remove"],"sources":["C:/Users/Азя/Desktop/chat/frontend/src/controllers/UserController.js"],"sourcesContent":["import Cookies from \"js-cookie\";\r\nimport axios from \"axios\";\r\n\r\nfunction auth_headers() {\r\n    return (Cookies.get('access_token') !== null) ? {\r\n        headers: {Authorization: `${Cookies.get('token_type')} ${Cookies.get('access_token')}`},\r\n    } : {};\r\n}\r\n\r\nasync function setCurrentUser(email, password) {\r\n    async function GetToken(email, password) {\r\n        const params = new URLSearchParams({ 'username': email, 'password': password });\r\n\r\n        try {\r\n            let response = await axios.post('http://localhost:443/auth/jwt/login', params);\r\n            return response.data;\r\n        }\r\n        catch (error) {\r\n            console.log(error);\r\n        }\r\n    }\r\n\r\n    try {\r\n        const data = await GetToken(email, password);\r\n\r\n        for (const [key, value] of Object.entries(data)) {\r\n            Cookies.set(key, value);\r\n        }\r\n\r\n        const response = await axios.get('http://localhost:443/users/me', auth_headers());\r\n\r\n        localStorage.setItem('current_user', JSON.stringify(response.data));\r\n\r\n        return 0;\r\n    }\r\n    catch (error) {\r\n        console.log(error);\r\n    }\r\n\r\n    return -1;\r\n}\r\n\r\nfunction currentUser() {\r\n    if (Cookies.get('access_token') == null) {\r\n        localStorage.setItem('current_user', null);\r\n        return null;\r\n    }\r\n\r\n    const data = localStorage.getItem('current_user');\r\n\r\n    if (data !== null)\r\n        return JSON.parse(data);\r\n\r\n    return null;\r\n}\r\n\r\nfunction clearCurrentUser() {\r\n    localStorage.setItem('current_user', null);\r\n\r\n    Cookies.remove('access_token');\r\n    Cookies.remove('token_type');\r\n}\r\n\r\nexport {auth_headers, setCurrentUser, currentUser, clearCurrentUser};\r\n"],"mappings":"AAAA,OAAOA,OAAO,MAAM,WAAW;AAC/B,OAAOC,KAAK,MAAM,OAAO;AAEzB,SAASC,YAAYA,CAAA,EAAG;EACpB,OAAQF,OAAO,CAACG,GAAG,CAAC,cAAc,CAAC,KAAK,IAAI,GAAI;IAC5CC,OAAO,EAAE;MAACC,aAAa,EAAG,GAAEL,OAAO,CAACG,GAAG,CAAC,YAAY,CAAE,IAAGH,OAAO,CAACG,GAAG,CAAC,cAAc,CAAE;IAAC;EAC1F,CAAC,GAAG,CAAC,CAAC;AACV;AAEA,eAAeG,cAAcA,CAACC,KAAK,EAAEC,QAAQ,EAAE;EAC3C,eAAeC,QAAQA,CAACF,KAAK,EAAEC,QAAQ,EAAE;IACrC,MAAME,MAAM,GAAG,IAAIC,eAAe,CAAC;MAAE,UAAU,EAAEJ,KAAK;MAAE,UAAU,EAAEC;IAAS,CAAC,CAAC;IAE/E,IAAI;MACA,IAAII,QAAQ,GAAG,MAAMX,KAAK,CAACY,IAAI,CAAC,qCAAqC,EAAEH,MAAM,CAAC;MAC9E,OAAOE,QAAQ,CAACE,IAAI;IACxB,CAAC,CACD,OAAOC,KAAK,EAAE;MACVC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IACtB;EACJ;EAEA,IAAI;IACA,MAAMD,IAAI,GAAG,MAAML,QAAQ,CAACF,KAAK,EAAEC,QAAQ,CAAC;IAE5C,KAAK,MAAM,CAACU,GAAG,EAAEC,KAAK,CAAC,IAAIC,MAAM,CAACC,OAAO,CAACP,IAAI,CAAC,EAAE;MAC7Cd,OAAO,CAACsB,GAAG,CAACJ,GAAG,EAAEC,KAAK,CAAC;IAC3B;IAEA,MAAMP,QAAQ,GAAG,MAAMX,KAAK,CAACE,GAAG,CAAC,+BAA+B,EAAED,YAAY,CAAC,CAAC,CAAC;IAEjFqB,YAAY,CAACC,OAAO,CAAC,cAAc,EAAEC,IAAI,CAACC,SAAS,CAACd,QAAQ,CAACE,IAAI,CAAC,CAAC;IAEnE,OAAO,CAAC;EACZ,CAAC,CACD,OAAOC,KAAK,EAAE;IACVC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;EACtB;EAEA,OAAO,CAAC,CAAC;AACb;AAEA,SAASY,WAAWA,CAAA,EAAG;EACnB,IAAI3B,OAAO,CAACG,GAAG,CAAC,cAAc,CAAC,IAAI,IAAI,EAAE;IACrCoB,YAAY,CAACC,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC;IAC1C,OAAO,IAAI;EACf;EAEA,MAAMV,IAAI,GAAGS,YAAY,CAACK,OAAO,CAAC,cAAc,CAAC;EAEjD,IAAId,IAAI,KAAK,IAAI,EACb,OAAOW,IAAI,CAACI,KAAK,CAACf,IAAI,CAAC;EAE3B,OAAO,IAAI;AACf;AAEA,SAASgB,gBAAgBA,CAAA,EAAG;EACxBP,YAAY,CAACC,OAAO,CAAC,cAAc,EAAE,IAAI,CAAC;EAE1CxB,OAAO,CAAC+B,MAAM,CAAC,cAAc,CAAC;EAC9B/B,OAAO,CAAC+B,MAAM,CAAC,YAAY,CAAC;AAChC;AAEA,SAAQ7B,YAAY,EAAEI,cAAc,EAAEqB,WAAW,EAAEG,gBAAgB"},"metadata":{},"sourceType":"module","externalDependencies":[]}